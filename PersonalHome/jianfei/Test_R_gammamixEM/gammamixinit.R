gammamix.init <- function(x, lambda = NULL, alpha = NULL, beta = NULL, k = 2) {
  n <- length(x)
  # x is a vector of 600 real numbers as following
  #   [1] 1.921603e-16 6.352891e-14 1.535888e-11 2.311205e-08 4.970993e-08 5.774234e-08 7.376630e-08
  #  [8] 1.067624e-07 2.723709e-07 2.033801e-06 7.522805e-06 1.705973e-05 3.977576e-05 5.221337e-05
  # [15] 6.932828e-05 1.131057e-04 1.281272e-04 1.540453e-04 2.871581e-04 3.962806e-04 4.751896e-04
  # [22] 4.817321e-04 5.007759e-04 5.356545e-04 5.740767e-04 6.151645e-04 6.159364e-04 8.220700e-04
  # [29] 8.683412e-04 9.776275e-04 1.030828e-03 1.218482e-03 1.475890e-03 1.702269e-03 2.253755e-03
  # [36] 3.171400e-03 4.437678e-03 4.469629e-03 5.892115e-03 5.971339e-03 5.999860e-03 6.180909e-03
  # [43] 6.514080e-03 7.160593e-03 7.367472e-03 7.642297e-03 8.071002e-03 1.000104e-02 1.018499e-02
  # [50] 1.450453e-02 1.521957e-02 1.545907e-02 1.901257e-02 1.925299e-02 2.085666e-02 2.637178e-02
  # [57] 2.834863e-02 2.861571e-02 3.121050e-02 3.413462e-02 3.468040e-02 3.899374e-02 4.005813e-02
  # [64] 4.807300e-02 5.012961e-02 5.059705e-02 5.089847e-02 5.452443e-02 5.513099e-02 5.877830e-02
  # [71] 6.645456e-02 7.892299e-02 7.924464e-02 8.814307e-02 9.270932e-02 9.683249e-02 1.015211e-01
  # [78] 1.021002e-01 1.084906e-01 1.121340e-01 1.140926e-01 1.198494e-01 1.218325e-01 1.230870e-01
  # [85] 1.331635e-01 1.376983e-01 1.390738e-01 1.481572e-01 1.523841e-01 1.605460e-01 1.633315e-01
  # [92] 1.773293e-01 1.780321e-01 1.789412e-01 1.960635e-01 1.973546e-01 2.022638e-01 2.101599e-01
  # [99] 2.376987e-01 2.612538e-01 3.290598e-01 3.293358e-01 3.321125e-01 3.489908e-01 3.615192e-01
  #[106] 3.757123e-01 3.924974e-01 3.989600e-01 4.053414e-01 4.255208e-01 4.280384e-01 4.281172e-01
  #[113] 4.683809e-01 4.705029e-01 5.090758e-01 5.302136e-01 5.543092e-01 5.805295e-01 6.563259e-01
  #[120] 6.972764e-01 8.192396e-01 8.817603e-01 9.028386e-01 9.029114e-01 9.378893e-01 9.738127e-01
  #[127] 9.777630e-01 1.014748e+00 1.020034e+00 1.026255e+00 1.035932e+00 1.122434e+00 1.149657e+00
  #[134] 1.185768e+00 1.228612e+00 1.243726e+00 1.287347e+00 1.307160e+00 1.309371e+00 1.309593e+00
  #[141] 1.329496e+00 1.372110e+00 1.375563e+00 1.596048e+00 1.640219e+00 1.740847e+00 1.786906e+00
  #[148] 1.798505e+00 1.904056e+00 1.984454e+00 2.143275e+00 2.211196e+00 2.483408e+00 2.507753e+00
  #[155] 2.518308e+00 2.546022e+00 2.581338e+00 2.712390e+00 2.761667e+00 2.806404e+00 2.815391e+00
  #[162] 2.963377e+00 3.264468e+00 3.435448e+00 3.943999e+00 4.251683e+00 4.321719e+00 4.368289e+00
  #[169] 4.451638e+00 4.510768e+00 4.530198e+00 4.648185e+00 5.368616e+00 5.556221e+00 5.574176e+00
  #[176] 6.266700e+00 6.585598e+00 6.761892e+00 7.065589e+00 7.902084e+00 8.131816e+00 8.147452e+00
  #[183] 8.181012e+00 8.387846e+00 8.442148e+00 8.976768e+00 9.414943e+00 9.489330e+00 1.024284e+01
  #[190] 1.042862e+01 1.048079e+01 1.054639e+01 1.056249e+01 1.128533e+01 1.129330e+01 1.147066e+01
  #[197] 1.163168e+01 1.163702e+01 1.209458e+01 1.230476e+01 1.242934e+01 1.248774e+01 1.256284e+01
  #[204] 1.266258e+01 1.294462e+01 1.315805e+01 1.359116e+01 1.380855e+01 1.412479e+01 1.449984e+01
  #[211] 1.463690e+01 1.464143e+01 1.466308e+01 1.471349e+01 1.521280e+01 1.569457e+01 1.610552e+01
  #[218] 1.644168e+01 1.648706e+01 1.675120e+01 1.677313e+01 1.700660e+01 1.717206e+01 1.725251e+01
  #[225] 1.727609e+01 1.747916e+01 1.756289e+01 1.774954e+01 1.794262e+01 1.799335e+01 1.818688e+01
  #[232] 1.836993e+01 1.843606e+01 1.852020e+01 1.866443e+01 1.882388e+01 1.900769e+01 1.910899e+01
  #[239] 1.936664e+01 1.937838e+01 1.950560e+01 1.955180e+01 1.978109e+01 1.986974e+01 1.998554e+01
  #[246] 2.001033e+01 2.019381e+01 2.054090e+01 2.056674e+01 2.061579e+01 2.081161e+01 2.087228e+01
  #[253] 2.093888e+01 2.104339e+01 2.128859e+01 2.137686e+01 2.169465e+01 2.174023e+01 2.206253e+01
  #[260] 2.215247e+01 2.228737e+01 2.244040e+01 2.250785e+01 2.265483e+01 2.276513e+01 2.286319e+01
  #[267] 2.288201e+01 2.313344e+01 2.316105e+01 2.357238e+01 2.365035e+01 2.375351e+01 2.438670e+01
  #[274] 2.481200e+01 2.497371e+01 2.550762e+01 2.563790e+01 2.566749e+01 2.576904e+01 2.579623e+01
  #[281] 2.589978e+01 2.614828e+01 2.622034e+01 2.630369e+01 2.666018e+01 2.674180e+01 2.678631e+01
  #[288] 2.684007e+01 2.750220e+01 2.771334e+01 2.783228e+01 2.788413e+01 2.800033e+01 2.818111e+01
  #[295] 2.832582e+01 2.836178e+01 2.913220e+01 2.926750e+01 2.931083e+01 2.958151e+01 2.970984e+01
  #[302] 2.992754e+01 3.008035e+01 3.018491e+01 3.039328e+01 3.045491e+01 3.047494e+01 3.053397e+01
  #[309] 3.060902e+01 3.062989e+01 3.113065e+01 3.127851e+01 3.144669e+01 3.168429e+01 3.186621e+01
  #[316] 3.201432e+01 3.223066e+01 3.226801e+01 3.242104e+01 3.250953e+01 3.261403e+01 3.277771e+01
  #[323] 3.298717e+01 3.300418e+01 3.307968e+01 3.317130e+01 3.333281e+01 3.335601e+01 3.337339e+01
  #[330] 3.337429e+01 3.338755e+01 3.375060e+01 3.384066e+01 3.394894e+01 3.396228e+01 3.436909e+01
  #[337] 3.477000e+01 3.529449e+01 3.602850e+01 3.604317e+01 3.605026e+01 3.612101e+01 3.621032e+01
  #[344] 3.624535e+01 3.721446e+01 3.744110e+01 3.749277e+01 3.758638e+01 3.802207e+01 3.804307e+01
  #[351] 3.812080e+01 3.820121e+01 3.841599e+01 3.841783e+01 3.871168e+01 3.934189e+01 3.952548e+01
  #[358] 4.025808e+01 4.034904e+01 4.050196e+01 4.066827e+01 4.089749e+01 4.097523e+01 4.102389e+01
  #[365] 4.121858e+01 4.174126e+01 4.199273e+01 4.301579e+01 4.323163e+01 4.325876e+01 4.453734e+01
  #[372] 4.487505e+01 4.496413e+01 4.523221e+01 4.554384e+01 4.562654e+01 4.584070e+01 4.597318e+01
  #[379] 4.605083e+01 4.608016e+01 4.643600e+01 4.673225e+01 4.741582e+01 4.847185e+01 4.893725e+01
  #[386] 4.915516e+01 5.044306e+01 5.071874e+01 5.156951e+01 5.190251e+01 5.196730e+01 5.276198e+01
  #[393] 5.526640e+01 5.699278e+01 5.723075e+01 5.855931e+01 5.906213e+01 6.514918e+01 6.593886e+01
  #[400] 8.629001e+01 2.123710e+02 2.174626e+02 2.179206e+02 2.264006e+02 2.277256e+02 2.313249e+02
  #[407] 2.328607e+02 2.351656e+02 2.385596e+02 2.390567e+02 2.412918e+02 2.419116e+02 2.432457e+02
  #[414] 2.464554e+02 2.466037e+02 2.510432e+02 2.514775e+02 2.532432e+02 2.552940e+02 2.571912e+02
  #[421] 2.585001e+02 2.586385e+02 2.587321e+02 2.591310e+02 2.593169e+02 2.593312e+02 2.593808e+02
  #[428] 2.595998e+02 2.619755e+02 2.636358e+02 2.647488e+02 2.648533e+02 2.653963e+02 2.663419e+02
  #[435] 2.676498e+02 2.681198e+02 2.694697e+02 2.704918e+02 2.748857e+02 2.757396e+02 2.767602e+02
  #[442] 2.768868e+02 2.772254e+02 2.781506e+02 2.790734e+02 2.795486e+02 2.795500e+02 2.803676e+02
  #[449] 2.808810e+02 2.812408e+02 2.829105e+02 2.829432e+02 2.829611e+02 2.831616e+02 2.842931e+02
  #[456] 2.846460e+02 2.865721e+02 2.875998e+02 2.895805e+02 2.895966e+02 2.900498e+02 2.911937e+02
  #[463] 2.918238e+02 2.932244e+02 2.938715e+02 2.949687e+02 2.954357e+02 2.965858e+02 2.969632e+02
  #[470] 2.981967e+02 2.985959e+02 3.007651e+02 3.012703e+02 3.027242e+02 3.029272e+02 3.030476e+02
  #[477] 3.040428e+02 3.052543e+02 3.073360e+02 3.079398e+02 3.083913e+02 3.090814e+02 3.094101e+02
  #[484] 3.101997e+02 3.102161e+02 3.123214e+02 3.124652e+02 3.132154e+02 3.132483e+02 3.135069e+02
  #[491] 3.142401e+02 3.145650e+02 3.183462e+02 3.187554e+02 3.195898e+02 3.218647e+02 3.227432e+02
  #[498] 3.231429e+02 3.234383e+02 3.246697e+02 3.247679e+02 3.247689e+02 3.250121e+02 3.263088e+02
  #[505] 3.270630e+02 3.279054e+02 3.285660e+02 3.287757e+02 3.287913e+02 3.291502e+02 3.292470e+02
  #[512] 3.297062e+02 3.308498e+02 3.320100e+02 3.323177e+02 3.324396e+02 3.325955e+02 3.330147e+02
  #[519] 3.342498e+02 3.352870e+02 3.360799e+02 3.376182e+02 3.376823e+02 3.382353e+02 3.392306e+02
  #[526] 3.392798e+02 3.400669e+02 3.401007e+02 3.403482e+02 3.411260e+02 3.420334e+02 3.434462e+02
  #[533] 3.436847e+02 3.442102e+02 3.446029e+02 3.458995e+02 3.474261e+02 3.475757e+02 3.479408e+02
  #[540] 3.481004e+02 3.499433e+02 3.500837e+02 3.519058e+02 3.531657e+02 3.534330e+02 3.536426e+02
  #[547] 3.545137e+02 3.549182e+02 3.555155e+02 3.559705e+02 3.584815e+02 3.591158e+02 3.600617e+02
  #[554] 3.634971e+02 3.638940e+02 3.661318e+02 3.696295e+02 3.699946e+02 3.724976e+02 3.741480e+02
  #[561] 3.764049e+02 3.767638e+02 3.787805e+02 3.789152e+02 3.805992e+02 3.818760e+02 3.826755e+02
  #[568] 3.830615e+02 3.835318e+02 3.847907e+02 3.848344e+02 3.900770e+02 3.912901e+02 3.923980e+02
  #[575] 3.925560e+02 3.938297e+02 3.960257e+02 3.980253e+02 3.982015e+02 3.991681e+02 4.009268e+02
  #[582] 4.023321e+02 4.025370e+02 4.043153e+02 4.058432e+02 4.138477e+02 4.173419e+02 4.240370e+02
  #[589] 4.310719e+02 4.311916e+02 4.364698e+02 4.403276e+02 4.445150e+02 4.537297e+02 4.609074e+02
  #[596] 4.665898e+02 4.966207e+02 4.985350e+02 5.324684e+02 5.861932e+02

  if (is.null(lambda)) {
    lambda = runif(k)   # runif(n, min = 0, max = 1)
    # Debug> runif(2)
    #[1] 0.5465927 0.8460821  generates random deviates in uniform distribution.
    lambda = lambda / sum(lambda)  # normalized to 1
  } else k = length(lambda)

  if (k == 1) {
    x.bar = mean(x)   # compute mean of the vector x
    x2.bar = mean(x^2) # compute squares of the elements of x
  } else {
    x.sort = sort(x)
    ind = floor(n * cumsum(lambda))
    # > cumsum(1:10)
    # [1]  1  3  6 10 15 21 28 36 45 55
    #> 1:10
    # [1]  1  2  3  4  5  6  7  8  9 10
    # Debug> cumsum(lambda)
    #[1] 0.3333333 0.6666667 1.0000000
    # n * cumsum(lambda), here n= 600
    # [1] 200 400 600
    # Debug> ind
    #[1] 200 400 600

    x.part = list()
    # Debug> x.part
    #list()
    x.part[[1]] = x.sort[1:(ind[1] + 1)]  # first [1, ind[1]+1 = 201 ] smallest data
    # Debug> x.part <--- x.sort[1, ind[1]+1 ] = x.sort[1 : 201]
    #[[1]]
    #  [1] 1.921603e-16 6.352891e-14 1 ...
    #  [197] 1.163168e+01 1.163702e+01 1.209458e+01 1.230476e+01(200th) 1.242934e+01(201th)
    for (j in 2:k) {
      x.part[[j]] = x.sort[ind[j - 1]:ind[j]]
      # x.part
      # [[2]]  <--- x.sort[ ind[1]: ind[2]  ] = x.sort[200: 400]
      #   [1] 12.30476(200th) 12.42934 12.48774 12.56284 12.66258
      #   [201] 86.29001(400th)

      # [[3]]  <--- x.sort[ ind[2]: ind[3]  ] = x.sort[400: 600]
      #  [1]  86.29001(400th) 212.37099 217.46255
      #  [199] 498.53497 532.46843 586.19323(600th)
    }

    x.bar = sapply(x.part, mean)
    # Debug> x.bar
    #[1]   1.948985  30.556443 325.343651
    # 1.948985 = mean(x.part[[1]]) = mean(x.sort[1 : 201])
    # Debug> mean(x.sort[1:201])
    #[1] 1.948985
    # Debug> mean(x.sort[200:400])
    #[1] 30.55644
    #Debug> mean(x.sort[400:600])
    #[1] 325.3437

    x2.bar = sapply(lapply(x.part, "^", 2), mean)
    # lapply(x.part, "^", 2) is squaring each element in x.sort[1:201], x.sort[200:400], x.sort[400:600]
    # [[1]]
    #  [1] 3.692558e-32(= 1th 1.921603e-16 ** 2 ) 4.035923e-27
    # [[2]]
    #  [1]  151.4071(=200th 1.230476e+01 ** 2)  154.4884
    # [[3]]
    #  [1]   7445.967(-400th 8.629001e+01 ** 2)  45101.438
    # then compute mean aftering squaring, in summary, the computation is like variance.
    #  mean (square (x.sort[1:201]) ),  mean (square (x.sort[200:400]) ), mean (square (x.sort[400:600])
  }
  if (is.null(alpha)) {
    alpha = x.bar^2 / (x2.bar - x.bar^2)
    # Is the estimation for alpha right ?, I see a different formula for alpha from gamma dist. wikipedia.
    # Debug> alpha
    #[1]  0.3571404  6.1872099 26.8053743
  }

  if (is.null(beta)) {
    beta = (x2.bar - x.bar^2) / x.bar
    # Debug> beta
    #[1]  5.457196  4.938647 12.137255
  }
  # Debug> lambda
  #[1] 0.3333333 0.3333333 0.3333333
  #Debug> alpha
  #[1]  0.3571404  6.1872099 26.8053743
  #Debug> beta
  #[1]  5.457196  4.938647 12.137255
  #Debug> k
  #[1] 3

  list(lambda = lambda, alpha = alpha, beta = beta, k = k)


}
